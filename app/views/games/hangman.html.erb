<% title "Hangman" %>
<div id="hangman">
<html>
<head>
<script language="JavaScript"><!--

state0 = new Array([",      +----+    \n",
				    "      |    |     \n",
				    "      |          \n",
				    "      |          \n",
				    "      |          \n",
				    "      |          \n",
				    "     ============"])
state1 = new Array([",      +----+    \n",
				    "      |    |     \n",
				    "      |    O     \n",
				    "      |          \n",
				    "      |          \n",
				    "      |          \n",
				    "     ============"])

state2 = new Array([",      +----+    \n",
				    "      |    |     \n",
				    "      |    O     \n",
				    "      |    |     \n",
				    "      |          \n",
				    "      |          \n",
				    "     ============"])

state3 = new Array([",      +----+    \n",
				    "      |    |     \n",
				    "      |    O     \n",
				    "      |   /|     \n",
				    "      |          \n",
				    "      |          \n",
				    "     ============"])

state4 = new Array([",      +----+    \n",
				    "      |    |     \n",
				    "      |    O     \n",
				    "      |   /|\\   \n",
				    "      |          \n",
				    "      |          \n",
				    "     ============"])

state5 = new Array([",      +----+    \n",
				    "      |    |     \n",
				    "      |    O     \n",
				    "      |   /|\\   \n",
				    "      |     \\   \n",
				    "      |          \n",
				    "     ============"])
		
state6 = new Array([",      +----+    \n",
				    "      |    |     \n",
				    "      |    O     \n",
				    "      |   /|\\   \n",
				    "      |   / \\   \n",
				    "      |  Owned   \n",
				    "     ============"])
gallows = new Array(state0, state1, state2, state3, state4, state5, state6)
function startAgain() {
 guesses = 0
 max = gallows.length-1
 guessed = " "
 toGuess = <%= '"' + @word.name + '"' %>
 displayHangman()
 displayToGuess()
 //displayGuessed()
}
function stayAway() {
 document.game.elements[3].focus()
 alert("Stop touching me!")
}
function usedLettersBox() {
 document.game.elements[3].focus()
 alert("This is the used letters box!")
}
function displayHangman() {
 document.game.status.value=gallows[guesses]
}
function displayToGuess() {
 pattern=""
 for(i=0;i<toGuess.length;++i) {
  if(guessed.indexOf(toGuess.charAt(i)) != -1)
   pattern += (toGuess.charAt(i)+" ")
  else pattern += "_ "
 }
 document.game.toGuess.value=pattern
}
//function displayGuessed() {
// document.game.guessed.value=guessed
//}
function badGuess(s) {
 if(toGuess.indexOf(s) == -1) return true
 return false
}
function winner() {
 for(i=0;i<toGuess.length;++i) {
  if(guessed.indexOf(toGuess.charAt(i)) == -1) return false
 }
 return true
}
function guess(s){
 s = s.toLowerCase()
 if(guessed.indexOf(s) == -1){
  guessed = s + " " + guessed
  if(badGuess(s)) ++guesses
  displayHangman()
  displayToGuess()
  //displayGuessed()
  if(guesses >= max){
   alert("You're dead. The word you missed was " + toGuess.toUpperCase() + ".")
   startAgain()
  }
  if(winner()) {
   alert("You won!")
   startAgain()
  }
 }
}
// --></SCRIPT>
</head>
<body>
<h2>Hangman</h2>
<form name="game">
<pre>
<div class="gallows"><textarea name="status" rows="6" cols="21" onfocus="stayAway()"></textarea><div>
</pre><P>
<div class="mystery-word"><input type="text" name="toGuess" onfocus="stayAway()"><br></div>
<input type="button" id = 'q' value=" Q " onclick="guess('q'); style.visibility = 'hidden';">
<input type="button" id = 'w' value=" W " onclick="guess('w'); style.visibility = 'hidden';">
<input type="button" id = 'e' value=" E " onclick="guess('e'); style.visibility = 'hidden';">
<input type="button" id = 'r' value=" R " onclick="guess('r'); style.visibility = 'hidden';">
<input type="button" id = 't' value=" T " onclick="guess('t'); style.visibility = 'hidden';">
<input type="button" id = 'y' value=" Y " onclick="guess('y'); style.visibility = 'hidden';">
<input type="button" id = 'u' value=" U " onclick="guess('u'); style.visibility = 'hidden';">
<input type="button" id = 'i' value=" I " onclick="guess('i'); style.visibility = 'hidden';">
<input type="button" id = 'o' value=" O " onclick="guess('o'); style.visibility = 'hidden';">
<input type="button" id = 'p' value=" P " onclick="guess('p'); style.visibility = 'hidden';"><br>
&nbsp;&nbsp;
<input type="button" id = 'a' value=" A " onclick="guess('a'); style.visibility = 'hidden';">
<input type="button" id = 's' value=" S " onclick="guess('s'); style.visibility = 'hidden';">
<input type="button" id = 'd' value=" D " onclick="guess('d'); style.visibility = 'hidden';">
<input type="button" id = 'f' value=" F " onclick="guess('f'); style.visibility = 'hidden';">
<input type="button" id = 'g' value=" G " onclick="guess('g'); style.visibility = 'hidden';">
<input type="button" id = 'h' value=" H " onclick="guess('h'); style.visibility = 'hidden';">
<input type="button" id = 'j' value=" J " onclick="guess('j'); style.visibility = 'hidden';">
<input type="button" id = 'k' value=" K " onclick="guess('k'); style.visibility = 'hidden';">
<input type="button" id = 'l' value=" L " onclick="guess('l'); style.visibility = 'hidden';"><br>
&nbsp;&nbsp;&nbsp&nbsp;&nbsp;
<input type="button" id = 'z' value=" Z " onclick="guess('z'); style.visibility = 'hidden';">
<input type="button" id = 'x' value=" X " onclick="guess('x'); style.visibility = 'hidden';">
<input type="button" id = 'c' value=" C " onclick="guess('c'); style.visibility = 'hidden';">
<input type="button" id = 'v' value=" V " onclick="guess('v'); style.visibility = 'hidden';">
<input type="button" id = 'b' value=" B " onclick="guess('b'); style.visibility = 'hidden';">
<input type="button" id = 'n' value=" N " onclick="guess('n'); style.visibility = 'hidden';">
<input type="button" id = 'm' value=" M " onclick="guess('m'); style.visibility = 'hidden';"><br>
<!--<div class="used-letters"><input type="text" name="guessed" onfocus="usedLettersBox()"><br></div>-->
<input type="text" onkeyup="if (this.value!='') { document.getElementById(this.value.toLowerCase()).style.visibility = 'hidden'; guess(this.value);}" onkeypress="this.value='';" value="Click letters or type here" onclick="this.value='';" maxlength="1"><br>
<%= button_to " Next word ", hangman_path, :method => :get %>
<!--<input type="button" name="restart" value=" Start Over " onclick="startAgain()">-->
<script language="JavaScript"><!--
startAgain()
// --></SCRIPT>
</form>
<%= "definition - " + @word.definitions.first.body unless @word.definitions.first.body.nil?%>
</body>
</html>
<!--TODO: add points for correct guess and refresh page after win or loss-->
</div>