<div id="user-search">
  <p><%= @users.size %> users and counting...</p>
  <% form_tag(finds_path, :method => 'get') do %>
    <%= text_field_tag(:user, I18n.t("Search for a user..."), :onFocus => "if(this.value==this.defaultValue) this.value='';", :onBlur  => "if(this.value=='') this.value=this.defaultValue;", 'id' => 'user_autocomplete') %>
  <% end %>
</div>

<h2><%= link_to @user.username, @user %></h2>
<p class="points"><%= pluralize(@user.points, "point") %></p>
<p class="member-since">Member since <%= @user.created_at.strftime("%B %d, %Y") %></p>

  <% if current_user and @user.id == current_user.id %>
    <% if current_user.facebook_user? %>
      <fb:profile-pic uid="<%= current_user.fb_user_id%>" facebook-logo="true" size="large" ></fb:profile-pic>
      <p><a href="#" onclick='FB.Connect.logoutAndRedirect("/logout")'>Logout</a></p>
    <% end %>
  <% else %>
  <% if @user.facebook_user? %>
    <fb:profile-pic uid="<%= @user.fb_user_id%>" facebook-logo="true" size="large" ></fb:profile-pic>
  <% end %>
<% end %>


<% if current_user %>
  <% if @user.id == current_user.id %>
    <p><%= link_to I18n.t("Edit Profile"), edit_user_path(:current) %></p>
  <% end %>
<% end %>

<h3>Based on votes, <%= link_to @user.username, @user %> is a <%= itemize_type @user_type %> user</h3>

<h3>Stats</h3>
<span><%= pluralize(@like_received, "like") %> received - <%= @like_percentage %></span><br>
<span><%= pluralize(@dislike_received, "dislike") %> received - <%= @dislike_percentage %></span><br>
<p>and</p>
<span><%= pluralize(@helpful_received, "helpful vote") %> received - <%= @helpful_percentage %></span><br>
<span><%= pluralize(@funny_received, "funny vote") %> received - <%= @funny_percentage %></span><br>
<span><%= pluralize(@poetic_received, "poetic vote") %> received - <%= @poetic_percentage %></span><br>

<% if @user.login != "wiktionary.org" %>
	
<h3>Points breakdown</h3>
<span><%= pluralize(@like_points, "point") %> for <%= pluralize(@like_received, "like") %> received</span><br>
<span><%= pluralize(@dislike_points, "point") %> for <%= pluralize(@dislike_received, "dislike") %> received</span><br>
<span><%= pluralize(@mood_points, "point") %> for <%= pluralize(@mood_votes_received, "helpful/funny/poetic vote") %> received</span><br>
<span><%= pluralize(@votes_cast_points, "point") %> for <%= pluralize(@votes_cast, "vote") %> cast</span><br>
<span><%= pluralize(@comments_posted_points, "point") %> for <%= pluralize(@comments_posted, "comment") %> posted</span><br>
<span><%= pluralize(@comments_received_points, "point") %> for <%= pluralize(@comments_received, "comment") %> received</span><br>
<span><%= pluralize(@definition_points, "bonus point") %> for <%= pluralize(@popular_definitions, "popular definition") %></span><br>
<span><%= pluralize(@facebook_points, "bonus point") %> for <%= (@user.facebook_user?)? "registering with Facebook": "not registering with Facebook" %></span><br>

<h3>Recent definitions</h3>
<% if @definitions %>
<div id="definitions">
    <%= render :partial => 'definitions/definition', :collection => @definitions, :locals => {:word => true} %>
</div>
<% else %>
<p>This user has not posted any definitions.</p>
<% end %>

<h3>Recent comments</h3>
<% if @comments %>
<ul id="user-comments">
  <%= render :partial => 'users/comment', :collection => @comments %>
</ul>
<% else %>
<p>This user has not posted any comments.</p>
<% end %>

<% end %>

<% content_for :sidebar do %>

  <div class="section">
    <h3>How points work:</h3>
    <p>for each</p>
    <table>
    <tr><td width="400">&nbsp&nbsp like received:<td width="20">+30</td></tr></tr>
    <tr><td>&nbsp&nbsp dislike received:<td>-15</td></tr>
    <tr><td>&nbsp&nbsp HFP vote received:<td>+10</td></tr>
    <tr><td>&nbsp&nbsp vote cast:<td>+1</td></tr>
    <tr><td>&nbsp&nbsp comment posted:<td>+1</td></tr>
    <tr><td>&nbsp&nbsp comment received:<td>+1</td></tr>
    <tr><td>bonuses</td></tr>
    <tr><td>&nbsp&nbsp definition with 5 likes<td>+100</td></tr>
    <tr><td>&nbsp&nbsp register with Facebook<td>+200</td></tr>
    </table><br>
    <p>HFP = helpful/funny/poetic</p>
  </div>
<% end %>